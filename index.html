<!DOCTYPE html>
<html lang="en">
<head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Metrix SDK HTML</title>
    <meta name="description" content="Generated by create next app">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/mvp.css">
    <script src="https://box.backtory.com/metricx/sdk/web/metrix.umd-latest.js" ></script>
</head>
<body>
<main>
    <h1>HTML + Pure JS</h1>
    <div>
        <h3>Enter Your username:</h3>
        <input id="login-input" placeholder="customer@mycompany.com">
        <button id="login-button">Login</button>
        <button id="logout-button">Logout</button>
        <p id="login-status">Your Anonymous!!!</p>
    </div>
    <div>
        <h3>Send sample user attribute</h3>
        <h5>Attributes:</h5>
        <div style="display: flex; justify-content: space-between"><label for="first-name-input">First
            Name:</label><input id="first-name-input" placeholder="First Name"></div>
        <div style="display: flex; justify-content: space-between"><label for="last-name-input">Last Name:</label><input
                id="last-name-input" placeholder="Last Name"></div>
        <div style="display: flex; justify-content: space-between"><label for="phone-input">Phone Number:</label><input
                id="phone-input" placeholder="Phone Number"></div>
        <h5>Custom Attributes:</h5>
        <div style="display: flex; justify-content: space-between">
            <label for="user-c-att-key-input">Key:</label><input id="user-c-att-key-input" placeholder="key">
            <label for="user-c-att-value-input">Value:</label><input id="user-c-att-value-input" placeholder="value">
        </div>
        <div style="display: flex; justify-content: space-between">
            <label for="user-c-att-key2-input">Key:</label><input id="user-c-att-key2-input" placeholder="key">
            <label for="user-c-att-value2-input">Value:</label><input id="user-c-att-value2-input" placeholder="value">
        </div>
        <button id="user-att-button">Send User</button>
    </div>
    <div>
        <h3>Send sample event with custom attribute:</h3>
        <div style="display: flex; justify-content: space-between">
            <label for="event-c-att-key-input">Key:</label><input id="event-c-att-key-input" placeholder="key">
            <label for="event-c-att-value-input">Value:</label><input id="event-c-att-value-input" placeholder="value">
        </div>
        <div style="display: flex; justify-content: space-between">
            <label for="event-c-att-key2-input">Key:</label><input id="event-c-att-key2-input" placeholder="key">
            <label for="event-c-att-value2-input">Value:</label><input id="event-c-att-value2-input" placeholder="value">
        </div>
        <button id="event-button">Send Event</button>
    </div>
    <script>
        const APP_ID = "<<enter your metrix app id here>>"
        const API_KEY = "<<enter your metrix api key here>>"
        const PUSH_PUBLIC_KEY = "<<enter your push public key here>>"
        const SAMPLE_EVENT_SLUG = "<<enter your metrix event slug here>>"

        let username = localStorage.getItem("username");

        const config = {
            push: {
                enabled : true, // defaults to false but if set to true you must provide publicKey.
                publicKey: PUSH_PUBLIC_KEY, // your push subscription public key.
            }
        }
        Metrix.init(APP_ID, API_KEY, config);

        if (username) {
            document.getElementById("login-status").innerHTML = "You're logged in as: " + username
            username = document.getElementById("login-input").value = username;
            Metrix.authorizeUser(username)
        }

        document.getElementById("login-button").onclick = () => {
            username = document.getElementById("login-input").value;
            localStorage.setItem("username", username)
            Metrix.authorizeUser(username)
            document.getElementById("login-status").innerHTML = "You're logged in as: " + username
        }

        document.getElementById("logout-button").onclick = () => {
            username = undefined
            localStorage.removeItem("username")
            Metrix.authorizeUser(username)
            document.getElementById("login-status").innerHTML = "You're logged out!!!"
        }

        document.getElementById("user-att-button").onclick = () => {
            const firstname = document.getElementById("first-name-input").value;
            const lastname = document.getElementById("last-name-input").value;
            const phone = document.getElementById("phone-input").value;
            const key = document.getElementById("user-c-att-key-input").value;
            const value = document.getElementById("user-c-att-value-input").value;
            const key2 = document.getElementById("user-c-att-key2-input").value;
            const value2 = document.getElementById("user-c-att-value2-input").value;

            if (firstname)
                window.Metrix.setFirstName(firstname)

            if (lastname)
                window.Metrix.setLastName(lastname)

            if (phone)
                window.Metrix.setPhoneNumber(phone)

            if (key && value)
                window.Metrix.setCustomAttribute(key, value)
            if (key2 && value2)
                window.Metrix.setCustomAttribute(key2, value2)

            alert("sending user attribute!")
        }


        document.getElementById("event-button").onclick = () => {
            const key = document.getElementById("event-c-att-key-input").value;
            const value = document.getElementById("event-c-att-value-input").value;
            const key2 = document.getElementById("event-c-att-key2-input").value;
            const value2 = document.getElementById("event-c-att-value2-input").value;

            const attributes = {};
            if (key && value)
                attributes[key] = value;
            if (key2 && value2)
                attributes[key2] = value2;

            Metrix.newEvent(SAMPLE_EVENT_SLUG, attributes);

            alert("sending event with attribute!")
        }

    </script>
</main>
</body>
</html>